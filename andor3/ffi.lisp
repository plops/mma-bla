(in-package :andor3)

(defparameter *andor3-library* 
  (load-shared-object "/usr/local/lib/libatcore.so"))

(define-alien-type handle int)
(define-alien-type at_bool int)
(define-alien-type at_64 long-long)
(define-alien-type wchar_t unsigned-int) ;; 32bit first byte contains ascii
(define-alien-type at_wc wchar_t)

(eval-when (:compile-toplevel)
 (defun split-by-one-hyphen (string)
   "Returns a list of substrings of string divided by ONE hyphen
each.  Note: Two consecutive hyphens will be seen as if there were an
empty string between them."
   (loop for i = 0 then (1+ j)
      as j = (position #\- string :start i)
      collect (subseq string i j)
      while j))

 (defun lisp-to-camel-case (name)
   "Convert initialise-library into AT_InitialiseLibrary."
   (declare (type simple-string name))
   (let* ((words (split-by-one-hyphen name))
	  (cwords (mapcar #'string-capitalize words)))
     (push "AT_" cwords)
     (format nil "狺泖矧潴┅＋铋箴扉舡怡镱瀛棂痂孱㈤铋糸犰轶瀛扉怛狎＋铋扉箴麸汜礤飙汜箦㈤铋糸犰轶瀛扉怛狎ㄤ彐磲泸钺礤脲ㄤ彐狨祠舂疳蜥眢⒂栾螋沲麸溴骈铄骢钽糸镱徙泔蜾轭麸篝犷溽蜾疳趑弪骘翳令滹幽鲥蝮轱钞涉呐屏仗轶趄蹂蝈趱蝾轭衄骈蝮狎珲礤铘轶栳钿戾犷箦泔钿狎珲礤铘轶縻栳蜻篝蜷铉啜溴骈铄犰殄瞽蝻豸轭ì扉箴麸汜礤飙汜箦簌礅镬钺礤钺礤┅ㄩ铘弪ㄣ镱汜翦钺翦篝蜷铉ア簌礅镬钺礤钺礤┅┅轭括麒孱溴驷蹯Жㄨ犷潇栳钿戾ㄦ遽趱蝈í縻栳蜻舂┅鲤狎犴螬换縻栳蜻轶巢忾镱睐付叨轭轸獒扉箦扉怛狎轰彐狨祠铋飑骈钺扉箦扉怛狎轰彐狨祠铋飑镳孱轰彐狨祠铋吼狎犴è汜礤蜥轭溴轭舂ㄨ犷潇栳钿戾猴豸┅沆矬轰彐狨祠铋吼狎犴è汜礤蜥轭溴轭舂┅＋铋ㄡ扉孱筢换汜祆忉汶筲犰殄詈横扉孱灬礅溽轭è栳钿戾ㄦ遽趱蝈í縻栳蜻舂ㄣ镱翦í轭舂┅┅蝈玳篝弪驽狒躜瀛汜祆忉汶吼狎犴è汜祆忉汶í轭舂ㄣ镱翦í轭舂┅躅蝈玳篝弪驽狒躜瀛汜祆忉汶吼狎犴è汜祆忉汶í轭舂ㄣ镱翦í轭舂┅轶轫痨屙孱翦吼狎犴è轫痨屙孱翦狒哜镲猴豸┅轶蝈徜徕戾吼狎犴è蝈徜徕戾狒哜镲猴豸┅轶黩轸徕戾吼狎犴è黩轸徕戾狒哜镲猴豸┅轶蝈徜镱禊吼狎犴è蝈徜镱禊狒哜镲猴豸┅箦舡轭吼狎犴è鲠祯狒叨穿┅珏舡轭吼狎犴è鲠祯狒叨猴豸┅珏舡轭舡磲吼狎犴è磲鲠祯狒叨猴豸┅珏舡轭舡黹吼狎犴è黹瞽鲠祯狒叨猴豸┅箦舡骒镝吼狎犴è鲠祯滹踱戾┅珏舡骒镝吼狎犴è鲠祯滹踱戾猴豸┅珏舡骒镝舡磲吼狎犴è磲鲠祯滹踱戾猴豸┅珏舡骒镝舡黹吼狎犴è黹瞽鲠祯滹踱戾猴豸┅箦舡怙镬吼狎犴è鲠祯狒哜镲飑┅珏舡怙镬吼狎犴è鲠祯狒哜镲猴豸┅箦舡孱蹴弪狒邃吼狎犴è鲠祯轭舂┅珏舡孱蹴弪狒邃吼狎犴è鲠祯轭猴豸┅珏舡孱蹴弪狒邃泔躅吼狎犴è泔躅轭猴豸┅箦舡孱蹴弪狒邃篝蜷铉吼狎犴è篝蜷铉í狒喵悌┅珏舡孱蹴弪狒邃篝蜷铉吼狎犴è篝蜷铉í狒喵悌戾铉翳轭舂┅轶孱蹴弪狒邃轭溴狯衢灬忪吼狎犴è轭溴轭舂ㄡ鲠殪徕戾狒哜镲猴豸┅轶孱蹴弪狒邃轭溴轫痨屙孱翦吼狎犴è轭溴轭舂ㄩ眇戾礤铘邃狒哜镲猴豸┅箦舡孱蹴轭溴吼狎犴è鲠祯轭舂┅箦舡孱蹴篝蜷铉吼狎犴è篝蜷铉í狒喵悌┅珏舡孱蹴轭溴吼狎犴è鲠祯轭猴豸┅珏舡孱蹴泔躅吼狎犴è泔躅轭猴豸┅轶孱蹴轭溴狯衢灬忪吼狎犴è轭溴轭舂ㄡ鲠殪徕戾狒哜镲猴豸┅轶孱蹴轭溴轫痨屙孱翦吼狎犴è轭溴轭舂ㄩ眇戾礤铘邃狒哜镲猴豸┅珏舡孱蹴篝蜷铉怡轭溴吼狎犴è轭溴轭舂篝蜷铉í狒喵悌戾铉翳轭舂┅狒咩镯磲钿箦舡篝蜷铉吼狎犴è篝蜷铉í狒喵悌┅珏舡篝蜷铉吼狎犴è篝蜷铉í狒喵悌戾铉翳轭舂┅珏舡篝蜷铉磲戾铉翳吼狎犴è磲篝蜷铉戾铉翳轭猴豸┅聃艴瀛怩骀弪吼狎犴è痿í躅箝珙邃汨狎┅ㄢ翦轭舂┅麽轸怩骀弪吼狎犴è痿躅箝珙邃祜铉猴豸换轸蝈趱蝾换痫轭翦麸犷换徜潋弩ㄢ翦轭猴豸糸礤秕躅箝珙邃轭舂┅骒躞轰彐狨祠铋吼狎犴è栳钿戾栳钿戾┅换汜躞虔祜汜殳轭沆蹁瀵狒泔蝈珧屦溴骈铄珧屦⑥ｉ姊珧屦猎吲匦珧屦猎孟遗珧屦猎吲乙狩痱轭áこ杯кЁげㄤ彐躅祜镫躔弪蝻ㄥ蝌ㄥ汜箦弪ūЯ赃乓疫蜗陨紊陨撂捎拍úЯ赃乓疫蜗陨托膛团卧拍ǔЯ赃乓疫遗聊衔藤ùЯ赃乓疫蜗砸帕牧绿农ǖЯ赃乓疫蜗宰疑粤绿农ǘЯ赃乓疫险韵埔廖桥ǚЯ赃乓疫晌呐匚显林辽塘绿农ǜЯ赃乓疫晌呐匚显赏刑磐盼耘末üЯ赃乓疫咆门拍拍土赜砸晌翘盼窃醛ūЯ赃乓疫孟挝琶陨衔ūЯ赃乓疫蜗牧粤ūЯ赃乓疫晌至躺娜廖奶农ūЯ赃乓疫陨团南赵ūЯ赃乓疫抡破乓普烫ūЯ赃乓疫晌至躺挠哨农ūЯ赃乓疫晌至躺牧躺俏团卧ūЯ赃乓疫孟屯ūЯ赃乓疫釉疑吻蜗粤至商谅膛ūЯ赃乓疫釉疑吻蜗陨托膛团卧拍úЯ赃乓疫握烫咂帕哉遗úЯ赃乓疫握烫呷廖奶农úЯ赃乓疫握烫呱托膛团卧拍咧烈úЯ赃乓疫握烫咭帕牧绿胚至药úЯ赃乓疫握烫咭帕南翁龠至药úЯ赃乓疫握烫咦疑粤绿胚至药úЯ赃乓疫握烫咄晌至陶农úЯ赃乓疫握烫咄霖至陶农úЯ赃乓疫握烫咧撂张úЯ赃乓疫握烫哂砸晌签ǔЯ赃乓疫握烫呙险卧咧烈ǔЯ赃乓疫握烫呱恿至商谅膛咧烈ǔЯ赃乓疫握烫咄霖釉疑吻膛吻匀ǔЯ赃乓疫握烫吲置撂搪撩拴ǔЯ赃乓疫握烫哐张张咝砸ǔЯ赃乓疫握烫咦辽赃性药ǔЯ赃乓疫握烫咝砸由谂ǔЯ赃乓疫蜗团拖屹ū鞍Я赃乓疫攘夷琢遗呦峙移滔砖┅＋铋祜镫躔弪蝻炒